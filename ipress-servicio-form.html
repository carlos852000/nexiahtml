<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NextIaDoctor • IPRESS • Servicios</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 50: '#eef2ff', 100: '#e0e7ff', 200: '#c7d2fe', 300: '#a5b4fc', 400: '#818cf8', 500: '#6366f1', 600: '#4f46e5', 700: '#4338ca', 800: '#3730a3', 900: '#312e81' },
                        accent: { 50: '#ecfeff', 100: '#cffafe', 200: '#a5f3fc', 300: '#67e8f9', 400: '#22d3ee', 500: '#06b6d4', 600: '#0891b2', 700: '#0e7490', 800: '#155e75', 900: '#164e63' }
                    },
                    boxShadow: { soft: '0 8px 24px rgba(2, 6, 23, 0.06)' }
                }
            }
        }
    </script>
    <style>
        * {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 transparent
        }

        *::-webkit-scrollbar {
            height: 8px;
            width: 8px
        }

        *::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 8px
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none
        }
    </style>
</head>

<body class="min-h-screen bg-slate-50 text-slate-800">
    <!-- Topbar con info IPRESS -->
    <header class="fixed inset-x-0 top-0 z-40 bg-gradient-to-r from-brand-600 to-accent-500 text-white shadow-soft">
        <div class="mx-auto flex h-16 max-w-screen-2xl items-center px-4">
            <div class="flex-1 flex items-center gap-4">
                <a href="dashboard.html" class="inline-flex items-center gap-3">
                    <div class="select-none text-lg font-semibold tracking-wide">NextIaCorp</div>
                </a>
                <!-- Chip de IPRESS activa -->
                <div
                    class="hidden md:flex items-center gap-2 rounded-lg bg-white/20 px-4 py-1.5 shadow-sm backdrop-blur-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        class="h-5 w-5 text-white">
                        <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                            d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                    </svg>
                    <span class="font-semibold text-white">Ipress San Martín</span>
                    <!--<span class="hidden text-xs text-white/70 md:inline">•</span>
                    <span class="hidden text-xs text-white/95 md:inline">RUC 20123456789</span>-->
                </div>
            </div>
            <nav class="flex items-center gap-2" aria-label="Navegación superior">
                <a href="reportes.html"
                    class="hidden rounded-lg bg-white/10 px-3 py-1.5 text-sm font-medium backdrop-blur hover:bg-white/20 md:inline">Reportes</a>
                <a href="soporte.html"
                    class="hidden rounded-lg bg-white/10 px-3 py-1.5 text-sm font-medium backdrop-blur hover:bg-white/20 md:inline">Soporte</a>
                <img src="https://api.dicebear.com/7.x/initials/svg?seed=ND" alt="avatar"
                    class="h-8 w-8 rounded-full ring-2 ring-white/30" />
            </nav>
        </div>
    </header>

    <!-- Menú Nivel 1 • IPRESS seleccionada (Servicios activo) -->
    <nav class="fixed top-16 inset-x-0 z-30 bg-white border-b border-slate-200 shadow-soft">
        <div class="mx-auto max-w-screen-2xl px-4">
            <div class="flex items-center justify-between">
                <!-- Tabs/menú de la IPRESS -->
                <div class="flex items-center overflow-x-auto py-2 gap-2 scrollbar-hide">
                    <a href="ipress-dashboard.html"
                        class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg
                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            class="h-5 w-5 text-brand-600">
                            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0h6" />
                        </svg><span>Dashboard</span></a>

                    <a href="ipress-sedes.html"  class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg><span>Sedes</span><span class="ml-1 rounded-full bg-brand-100 px-1.5 py-0.5 text-xs font-medium text-brand-800">5</span></a>

                    <a href="ipress-usuarios.html"
                        class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg
                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            class="h-5 w-5 text-brand-600">
                            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg><span>Usuarios</span></a>

                    <a href="ipress-medicos.html"
                        class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg
                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            class="h-5 w-5 text-brand-600">
                            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                d="M4 7a4 4 0 118 0 4 4 0 01-8 0zm12 4h4m-2-2v4m-6 4a6 6 0 10-12 0" />
                        </svg><span>Médicos</span></a>

                    <a href="ipress-servicios.html" aria-current="page"
                        class="flex items-center gap-2 rounded-lg bg-brand-50 px-3 py-2 text-sm font-medium text-brand-700 border-b-2 border-brand-600 transition-all"><svg
                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            class="h-5 w-5 text-brand-600">
                            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                        </svg><span>Servicios</span></a>
                </div>

                <!-- Acciones rápidas a la derecha -->
                <div class="flex items-center gap-2">
                    <a href="ipress-agenda.html"
                        class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg
                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            class="h-5 w-5 text-brand-600">
                            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                d="M8 7V3m8 4V3M3 11h18M5 19h14a2 2 0 002-2v-6H3v6a2 2 0 002 2z" />
                        </svg><span>Agenda</span></a>
                    <a href="ipress-reservas.html"
                        class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg
                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            class="h-5 w-5 text-brand-600">
                            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                d="M12 6v12m6-6H6" />
                        </svg><span>Reservas</span></a>
                    <a href="ipress-atenciones.html"
                        class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg
                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            class="h-5 w-5 text-brand-600">
                            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
                        </svg><span>Atenciones</span></a>
                    <a href="ipress-reportes.html"
                        class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg
                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            class="h-5 w-5 text-brand-600">
                            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                d="M12 14l9-5-9-5-9 5 9 5z" />
                            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                d="M12 14l6.16-3.422A12.083 12.083 0 016 8.577M12 14v7" />
                        </svg><span>Reportes</span></a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main -->
    <main class="pt-36 pb-24">
        <div class="mx-auto max-w-screen-2xl px-6">
            <!-- Encabezado y acciones -->
            <div class="mb-6 flex flex-wrap items-center justify-between gap-3">
                <div>
                    <nav class="text-xs text-slate-500">
                        <a class="hover:underline" href="ipress.html">IPRESS</a> /
                        <a class="hover:underline" href="ipress-servicios.html">Servicios</a> /
                        <span class="text-slate-700 font-medium">Registrar servicio</span>
                    </nav>
                    <h1 class="mt-1 text-2xl font-semibold tracking-tight text-slate-800">Registrar servicio clínico
                    </h1>
                    <p class="text-sm text-slate-500">
                        Crea el servicio en <code>servicio_clinico</code>, asigna <code>especialidades</code>, actívalo
                        por <code>sedes/consultorios</code>,
                        define <code>recursos</code> y configura <code>coberturas</code>.
                    </p>
                </div>
                <div class="flex items-center gap-2">
                    <a href="ipress-servicios.html"
                        class="rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50">←
                        Volver a Servicios</a>
                </div>
            </div>

            <form id="formServicio" class="grid gap-6 lg:grid-cols-3">
                <!-- Columna principal -->
                <section class="space-y-6 lg:col-span-2">
                    <!-- Datos del servicio (servicio_clinico) -->
                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
                        <div class="mb-4 flex items-center justify-between">
                            <h2 class="text-lg font-semibold">Datos del servicio</h2>
                            <div class="text-xs text-slate-500">Fuente: tabla <code>servicio_clinico</code></div>
                        </div>
                        <div class="grid gap-4 md:grid-cols-6">
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Código</label>
                                <input name="codigo" required placeholder="Ej. CONS-001"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
                            </div>
                            <div class="md:col-span-3">
                                <label class="mb-1 block text-sm font-medium text-slate-700">Nombre del servicio</label>
                                <input name="nombre" required placeholder="Ej. Consulta de Medicina Interna"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
                            </div>
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Categoría</label>
                                <select name="categoria" required
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:outline-none">
                                    <option value="">Seleccione…</option>
                                    <option>Consulta</option>
                                    <option>Imagen</option>
                                    <option>Laboratorio</option>
                                    <option>Procedimiento</option>
                                    <option>Terapia</option>
                                </select>
                            </div>
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Subcategoría
                                    (opcional)</label>
                                <input name="subcategoria" placeholder="Ej. Ambulatoria"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
                            </div>

                            <div class="md:col-span-3">
                                <label class="mb-1 block text-sm font-medium text-slate-700">Descripción</label>
                                <textarea name="descripcion" rows="2"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20"
                                    placeholder="Breve descripción del alcance del servicio"></textarea>
                            </div>
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Duración (min)</label>
                                <input name="duracion" type="number" min="5" step="5" value="30"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
                            </div>
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Precio base (S/)</label>
                                <input name="precio" type="number" step="0.01" min="0" value="0.00"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 text-right focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
                            </div>
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Estado</label>
                                <select name="estado"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:outline-none">
                                    <option>ACTIVO</option>
                                    <option>INACTIVO</option>
                                </select>
                            </div>
                            <div class="flex items-end">
                                <label
                                    class="inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2">
                                    <input type="checkbox" name="visible" class="h-4 w-4 rounded border-slate-300"
                                        checked>
                                    <span class="text-sm">Visible para reservas</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Reglas y requisitos -->
                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
                        <div class="mb-4 flex items-center justify-between">
                            <h2 class="text-lg font-semibold">Reglas y requisitos</h2>
                            <div class="text-xs text-slate-500">Políticas operativas del servicio</div>
                        </div>
                        <div class="grid gap-4 md:grid-cols-6">
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Requiere orden</label>
                                <select name="requiere_orden"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:outline-none">
                                    <option>No</option>
                                    <option>Sí</option>
                                </select>
                            </div>
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Requiere
                                    autorización</label>
                                <select name="requiere_autorizacion"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:outline-none">
                                    <option>No</option>
                                    <option>Sí</option>
                                </select>
                            </div>
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Sexo</label>
                                <select name="sexo"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:outline-none">
                                    <option>Indistinto</option>
                                    <option>Femenino</option>
                                    <option>Masculino</option>
                                </select>
                            </div>
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Edad mínima</label>
                                <input name="edad_min" type="number" min="0"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
                            </div>
                            <div>
                                <label class="mb-1 block text-sm font-medium text-slate-700">Edad máxima</label>
                                <input name="edad_max" type="number" min="0"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
                            </div>
                            <div class="md:col-span-6">
                                <label class="mb-1 block text-sm font-medium text-slate-700">Preparación del paciente
                                    (opcional)</label>
                                <textarea name="preparacion" rows="2"
                                    class="w-full rounded-xl border border-slate-200 px-3 py-2.5 focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20"
                                    placeholder="Indicaciones previas al servicio"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Especialidades (especialidad_servicio_clinico) -->
                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
                        <div class="mb-4 flex items-center justify-between">
                            <h2 class="text-lg font-semibold">Especialidades</h2>
                            <div class="text-xs text-slate-500">Fuente: <code>especialidad_servicio_clinico</code></div>
                        </div>
                        <div id="espWrap" class="space-y-3"></div>
                        <button type="button" id="addEsp"
                            class="mt-3 rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm hover:bg-slate-50">
                            + Agregar especialidad
                        </button>
                    </div>

                    <!-- Activación por sedes y consultorios (sede_servicio) -->
                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
                        <div class="mb-4 flex items-center justify-between">
                            <h2 class="text-lg font-semibold">Activación en sedes y consultorios</h2>
                            <div class="text-xs text-slate-500">Fuente: <code>sede_servicio</code></div>
                        </div>
                        <div id="sedesWrap" class="space-y-3"></div>
                        <button type="button" id="addSede"
                            class="mt-3 rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm hover:bg-slate-50">
                            + Agregar sede
                        </button>
                        <p class="mt-2 text-[11px] text-slate-500">Puedes sobreescribir precio/duración por sede
                            (opcional).</p>
                    </div>

                    <!-- Recursos requeridos (servicio_recurso) -->
                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
                        <div class="mb-4 flex items-center justify-between">
                            <h2 class="text-lg font-semibold">Recursos requeridos</h2>
                            <div class="text-xs text-slate-500">Fuente: <code>servicio_recurso</code></div>
                        </div>
                        <div id="recWrap" class="space-y-3"></div>
                        <button type="button" id="addRec"
                            class="mt-3 rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm hover:bg-slate-50">
                            + Agregar recurso
                        </button>
                    </div>

                    <!-- Cobertura por plan (plan_servicio_cobertura) -->
                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
                        <div class="mb-4 flex items-center justify-between">
                            <h2 class="text-lg font-semibold">Cobertura por plan</h2>
                            <div class="text-xs text-slate-500">Fuente: <code>plan_servicio_cobertura</code></div>
                        </div>
                        <div id="cobWrap" class="space-y-3"></div>
                        <button type="button" id="addCob"
                            class="mt-3 rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm hover:bg-slate-50">
                            + Agregar cobertura
                        </button>
                    </div>
                </section>

                <!-- Lateral -->
                <aside class="space-y-6">
                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
                        <h3 class="mb-3 text-sm font-semibold text-slate-800">Acciones</h3>
                        <div class="grid gap-2">
                            <button type="submit"
                                class="w-full rounded-lg bg-brand-600 px-4 py-2 text-sm font-semibold text-white hover:bg-brand-700">
                                Guardar servicio
                            </button>
                            <button type="button" id="btnLimpiar"
                                class="w-full rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50">
                                Limpiar
                            </button>
                            <a href="ipress-servicios.html"
                                class="w-full rounded-lg border border-slate-200 bg-white px-4 py-2 text-center text-sm font-medium text-slate-700 hover:bg-slate-50">
                                Cancelar
                            </a>
                        </div>
                    </div>

                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
                        <h3 class="mb-2 text-sm font-semibold text-slate-800">Resumen</h3>
                        <ul class="text-sm text-slate-600" id="resumen">
                            <li><span class="text-slate-500">Código:</span> —</li>
                            <li><span class="text-slate-500">Servicio:</span> —</li>
                            <li><span class="text-slate-500">Categoría:</span> —</li>
                            <li><span class="text-slate-500">Precio base:</span> S/ 0.00</li>
                            <li><span class="text-slate-500">Duración:</span> 0 min</li>
                            <li><span class="text-slate-500">Reqs:</span> Orden: No • Aut: No</li>
                            <li><span class="text-slate-500">Especialidades:</span> 0</li>
                            <li><span class="text-slate-500">Sedes:</span> 0</li>
                            <li><span class="text-slate-500">Coberturas:</span> 0</li>
                            <li><span class="text-slate-500">Estado:</span> ACTIVO • <span>Visible</span></li>
                        </ul>
                    </div>

                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
                        <h3 class="mb-2 text-sm font-semibold text-slate-800">Buenas prácticas</h3>
                        <ul class="list-disc pl-5 text-xs text-slate-600 space-y-1">
                            <li>Registra al menos una <strong>especialidad</strong> para relacionarlo con agendas.</li>
                            <li>Actívalo en <strong>sedes</strong> antes de publicar horarios.</li>
                            <li>Configura <strong>coberturas</strong> si trabajas con aseguradoras.</li>
                        </ul>
                    </div>
                </aside>
            </form>
        </div>
    </main>

    <!-- Footer (opcional si ya tienes uno global) -->
    <footer class="fixed bottom-0 left-0 right-0 z-40 border-t border-slate-200 bg-white/90 backdrop-blur">
        <div class="mx-auto flex h-12 max-w-screen-2xl items-center justify-between px-6 text-sm text-slate-600">
            <p>© <span id="y"></span> NextIaCorp • Todos los derechos reservados</p>
            <nav class="hidden gap-4 md:flex">
                <a class="hover:text-slate-900" href="privacidad.html">Privacidad</a>
                <a class="hover:text-slate-900" href="terminos.html">Términos</a>
                <a class="hover:text-slate-900" href="contacto.html">Contacto</a>
            </nav>
        </div>
    </footer>

    <!-- Templates -->
    <template id="tplEsp">
        <div class="grid gap-3 md:grid-cols-6 border border-slate-100 rounded-xl p-3">
            <div class="md:col-span-4">
                <label class="mb-1 block text-xs font-medium text-slate-600">Especialidad</label>
                <select name="especialidad[]"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:outline-none">
                    <option value="">Seleccione…</option>
                    <option>Medicina Interna</option>
                    <option>Pediatría</option>
                    <option>Ginecología</option>
                    <option>Radiología</option>
                </select>
            </div>
            <div class="md:col-span-1">
                <label class="mb-1 block text-xs font-medium text-slate-600">Principal</label>
                <select name="esp_principal[]"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:outline-none">
                    <option>No</option>
                    <option>Sí</option>
                </select>
            </div>
            <div class="md:col-span-1 flex items-end">
                <button type="button"
                    class="removeEsp w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm hover:bg-slate-50">Quitar</button>
            </div>
        </div>
    </template>

    <template id="tplSede">
        <div class="grid gap-3 md:grid-cols-8 border border-slate-100 rounded-xl p-3">
            <div class="md:col-span-2">
                <label class="mb-1 block text-xs font-medium text-slate-600">Sede</label>
                <select name="sede[]"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:outline-none">
                    <option value="">Seleccione…</option>
                    <option value="SE-001">Miraflores</option>
                    <option value="SE-002">San Isidro</option>
                    <option value="SE-003">Surco</option>
                </select>
            </div>
            <div class="md:col-span-3">
                <label class="mb-1 block text-xs font-medium text-slate-600">Consultorios</label>
                <select name="consultorios[]" multiple
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:outline-none">
                    <option value="C-101">Piso 1 — 101</option>
                    <option value="C-102">Piso 1 — 102</option>
                    <option value="C-201">Piso 2 — 201</option>
                    <option value="C-202">Piso 2 — 202</option>
                </select>
                <p class="mt-1 text-[11px] text-slate-500">Ctrl/Cmd para varias opciones.</p>
            </div>
            <div>
                <label class="mb-1 block text-xs font-medium text-slate-600">Duración (min)</label>
                <input name="duracion_sede[]" type="number" min="5" step="5" placeholder="—"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
            </div>
            <div>
                <label class="mb-1 block text-xs font-medium text-slate-600">Precio (S/)</label>
                <input name="precio_sede[]" type="number" step="0.01" min="0" placeholder="—"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-right text-sm focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
            </div>
            <div class="md:col-span-1 flex items-end">
                <button type="button"
                    class="removeSede w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm hover:bg-slate-50">Quitar</button>
            </div>
        </div>
    </template>

    <template id="tplRec">
        <div class="grid gap-3 md:grid-cols-6 border border-slate-100 rounded-xl p-3">
            <div>
                <label class="mb-1 block text-xs font-medium text-slate-600">Tipo</label>
                <select name="tipo_recurso[]"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:outline-none">
                    <option>Equipo</option>
                    <option>Sala</option>
                    <option>Personal</option>
                    <option>Material</option>
                </select>
            </div>
            <div class="md:col-span-3">
                <label class="mb-1 block text-xs font-medium text-slate-600">Recurso</label>
                <input name="recurso[]" placeholder="Ej. Ecógrafo / Sala RX / Técnico RX"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
            </div>
            <div>
                <label class="mb-1 block text-xs font-medium text-slate-600">Cantidad</label>
                <input name="cantidad_recurso[]" type="number" min="1" value="1"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
            </div>
            <div class="flex items-end">
                <label class="inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 w-full">
                    <input type="checkbox" name="obligatorio[]" class="h-4 w-4 rounded border-slate-300">
                    <span class="text-sm">Obligatorio</span>
                </label>
            </div>
            <div class="md:col-span-1 flex items-end">
                <button type="button"
                    class="removeRec w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm hover:bg-slate-50">Quitar</button>
            </div>
        </div>
    </template>

    <template id="tplCob">
        <div class="grid gap-3 md:grid-cols-8 border border-slate-100 rounded-xl p-3">
            <div class="md:col-span-2">
                <label class="mb-1 block text-xs font-medium text-slate-600">Aseguradora</label>
                <select name="aseguradora[]"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:outline-none">
                    <option value="">Seleccione…</option>
                    <option>Rimac</option>
                    <option>Pacífico</option>
                    <option>Mapfre</option>
                </select>
            </div>
            <div class="md:col-span-2">
                <label class="mb-1 block text-xs font-medium text-slate-600">Plan</label>
                <select name="plan[]"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:outline-none">
                    <option value="">Seleccione…</option>
                    <option>Plan A</option>
                    <option>Plan B</option>
                </select>
            </div>
            <div>
                <label class="mb-1 block text-xs font-medium text-slate-600">Tipo</label>
                <select name="tipo_cobertura[]"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:outline-none">
                    <option value="NO">No cubierto</option>
                    <option value="COPAGO">Copago fijo</option>
                    <option value="PORC">Porcentaje cubierto</option>
                </select>
            </div>
            <div>
                <label class="mb-1 block text-xs font-medium text-slate-600">Monto / %</label>
                <input name="monto_cobertura[]" type="number" step="0.01" min="0" placeholder="0.00"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-right text-sm focus:border-brand-600 focus:ring-4 focus:ring-brand-600/20" />
            </div>
            <div>
                <label class="mb-1 block text-xs font-medium text-slate-600">Autorización</label>
                <select name="autorizacion_plan[]"
                    class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm focus:border-brand-600 focus:outline-none">
                    <option>No</option>
                    <option>Sí</option>
                </select>
            </div>
            <div class="md:col-span-1 flex items-end">
                <button type="button"
                    class="removeCob w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm hover:bg-slate-50">Quitar</button>
            </div>
        </div>
    </template>

    <!-- Scripts -->
    <script>
            // Año footer
            (document.getElementById('y') || {}).textContent = new Date().getFullYear();

        // Helpers resumen
        const updateResumen = () => {
            const codigo = document.querySelector('[name="codigo"]').value || '—';
            const nombre = document.querySelector('[name="nombre"]').value || '—';
            const cat = document.querySelector('[name="categoria"]').value || '—';
            const dur = document.querySelector('[name="duracion"]').value || '0';
            const precio = parseFloat(document.querySelector('[name="precio"]').value || '0').toFixed(2);
            const reqOrd = document.querySelector('[name="requiere_orden"]').value || 'No';
            const reqAut = document.querySelector('[name="requiere_autorizacion"]').value || 'No';
            const esp = document.querySelectorAll('#espWrap > .grid').length;
            const sed = document.querySelectorAll('#sedesWrap > .grid').length;
            const cob = document.querySelectorAll('#cobWrap > .grid').length;
            const estado = document.querySelector('[name="estado"]').value || 'ACTIVO';
            const vis = document.querySelector('[name="visible"]').checked ? 'Visible' : 'Oculto';

            document.getElementById('resumen').innerHTML = `
            <li><span class="text-slate-500">Código:</span> ${codigo}</li>
            <li><span class="text-slate-500">Servicio:</span> ${nombre}</li>
            <li><span class="text-slate-500">Categoría:</span> ${cat}</li>
            <li><span class="text-slate-500">Precio base:</span> S/ ${isNaN(precio) ? '0.00' : precio}</li>
            <li><span class="text-slate-500">Duración:</span> ${dur} min</li>
            <li><span class="text-slate-500">Reqs:</span> Orden: ${reqOrd} • Aut: ${reqAut}</li>
            <li><span class="text-slate-500">Especialidades:</span> ${esp}</li>
            <li><span class="text-slate-500">Sedes:</span> ${sed}</li>
            <li><span class="text-slate-500">Coberturas:</span> ${cob}</li>
            <li><span class="text-slate-500">Estado:</span> ${estado} • <span>${vis}</span></li>`;
        };
        const bindResumenInputs = () => {
            document.querySelectorAll('[name="codigo"], [name="nombre"], [name="categoria"], [name="duracion"], [name="precio"], [name="requiere_orden"], [name="requiere_autorizacion"], [name="estado"], [name="visible"]').forEach(el => {
                el.addEventListener('input', updateResumen);
                el.addEventListener('change', updateResumen);
            });
        };
        bindResumenInputs(); updateResumen();

        // Especialidades dinámicas
        const espWrap = document.getElementById('espWrap');
        const tplEsp = document.getElementById('tplEsp');
        const addEsp = () => {
            const node = tplEsp.content.cloneNode(true);
            espWrap.appendChild(node);
            espWrap.querySelectorAll('.removeEsp').forEach(btn => btn.onclick = (e) => { e.currentTarget.closest('.grid').remove(); updateResumen(); });
            espWrap.querySelectorAll('select').forEach(el => el.oninput = updateResumen);
            updateResumen();
        };
        document.getElementById('addEsp').onclick = addEsp;
        addEsp(); // una por defecto

        // Sedes dinámicas
        const sedesWrap = document.getElementById('sedesWrap');
        const tplSede = document.getElementById('tplSede');
        const addSede = () => {
            const node = tplSede.content.cloneNode(true);
            sedesWrap.appendChild(node);
            sedesWrap.querySelectorAll('.removeSede').forEach(btn => btn.onclick = (e) => { e.currentTarget.closest('.grid').remove(); updateResumen(); });
            sedesWrap.querySelectorAll('select, input').forEach(el => el.oninput = updateResumen);
            updateResumen();
        };
        document.getElementById('addSede').onclick = addSede;

        // Recursos dinámicos
        const recWrap = document.getElementById('recWrap');
        const tplRec = document.getElementById('tplRec');
        const addRec = () => {
            const node = tplRec.content.cloneNode(true);
            recWrap.appendChild(node);
            recWrap.querySelectorAll('.removeRec').forEach(btn => btn.onclick = (e) => { e.currentTarget.closest('.grid').remove(); });
        };
        document.getElementById('addRec').onclick = addRec;

        // Coberturas dinámicas
        const cobWrap = document.getElementById('cobWrap');
        const tplCob = document.getElementById('tplCob');
        const addCob = () => {
            const node = tplCob.content.cloneNode(true);
            cobWrap.appendChild(node);
            cobWrap.querySelectorAll('.removeCob').forEach(btn => btn.onclick = (e) => { e.currentTarget.closest('.grid').remove(); updateResumen(); });
            cobWrap.querySelectorAll('select, input').forEach(el => el.oninput = updateResumen);
            updateResumen();
        };
        document.getElementById('addCob').onclick = addCob;

        // Limpiar
        document.getElementById('btnLimpiar').onclick = () => {
            const f = document.getElementById('formServicio');
            f.reset();
            espWrap.innerHTML = ''; sedesWrap.innerHTML = ''; recWrap.innerHTML = ''; cobWrap.innerHTML = '';
            addEsp(); updateResumen();
        };

        // Validación + redirección (demo)
        document.getElementById('formServicio').addEventListener('submit', function (e) {
            e.preventDefault();
            const codigo = (this.codigo.value || '').trim();
            const nombre = (this.nombre.value || '').trim();
            const categoria = (this.categoria.value || '').trim();
            if (!codigo) return alert('El código es obligatorio.');
            if (!nombre) return alert('El nombre del servicio es obligatorio.');
            if (!categoria) return alert('La categoría es obligatoria.');
            alert('Servicio guardado correctamente (demo).');
            window.location.href = 'ipress-servicios.html';
        });
    </script>
</body>

</html>