<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NextIaDoctor • Sede • Horarios (Bandeja)</title>
  <!-- Tailwind para prototipo -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {50:'#eef2ff',100:'#e0e7ff',200:'#c7d2fe',300:'#a5b4fc',400:'#818cf8',500:'#6366f1',600:'#4f46e5',700:'#4338ca',800:'#3730a3',900:'#312e81'},
            accent: {50:'#ecfeff',100:'#cffafe',200:'#a5f3fc',300:'#67e8f9',400:'#22d3ee',500:'#06b6d4',600:'#0891b2',700:'#0e7490',800:'#155e75',900:'#164e63'}
          },
          boxShadow: { soft:'0 8px 24px rgba(2,6,23,.06)'}
        }
      }
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <style>
    *{ scrollbar-width: thin; scrollbar-color: #cbd5e1 transparent; }
    *::-webkit-scrollbar{height:8px;width:8px}
    *::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:8px}
    .scrollbar-hide::-webkit-scrollbar{display:none}
    .scrollbar-hide{ -ms-overflow-style:none; scrollbar-width:none }
    .grid-week{ display:grid; grid-template-columns: 64px repeat(7, 1fr); }
    .grid-hours{ display:grid; grid-template-rows: repeat(12, 56px); }
    .slot{ position:relative; }
    .event{ position:absolute; left:6px; right:6px; border-radius:10px; padding:6px 8px; font-size:12px; line-height:1.1; box-shadow:0 6px 16px rgba(2,6,23,.08); cursor:pointer; transition:all 0.2s ease; }
    .event:hover{ transform:scale(1.02); box-shadow:0 8px 24px rgba(2,6,23,.12); }
    .event b{ font-weight:600; }
    .event .text-xs{ font-size:11px; opacity:0.9; }
    .event .text-\[10px\]{ font-size:10px; opacity:0.8; }
  </style>
</head>
<body class="min-h-screen bg-slate-50 text-slate-800">
  <!-- Topbar -->
  <header class="fixed inset-x-0 top-0 z-40 bg-gradient-to-r from-brand-600 to-accent-500 text-white shadow-soft">
    <div class="mx-auto flex h-16 max-w-screen-2xl items-center justify-between px-4">
      <div class="flex items-center gap-3">
        <a href="ipress-sedes.html" class="inline-flex items-center gap-3">
          <div class="select-none text-lg font-semibold tracking-wide">NextIaCorp</div>
        </a>
        <!-- Breadcrumb contextual -->
        <div class="hidden items-center gap-2 rounded-lg bg-white/15 px-3 py-1.5 md:flex">
          <span class="font-semibold">IPRESS San Martín</span>
          <span class="hidden text-xs text-white/70 md:inline">›</span>
          <span class="hidden text-xs text-white/95 md:inline">Sede Miraflores</span>
        </div>
      </div>
      <nav class="flex items-center gap-2">
        <a href="#" class="hidden rounded-lg bg-white/10 px-3 py-1.5 text-sm font-medium backdrop-blur hover:bg-white/20 md:inline">Soporte</a>
        <img src="https://api.dicebear.com/7.x/initials/svg?seed=ND" alt="avatar" class="h-8 w-8 rounded-full ring-2 ring-white/30"/>
      </nav>
    </div>
  </header>

  <!-- NAV NIVEL 2 (Sede) -->
  <nav class="fixed top-16 inset-x-0 z-30 bg-white border-b border-slate-200 shadow-soft" aria-label="Navegación de Sede">
    <div class="mx-auto max-w-screen-2xl px-4">
      <div class="flex items-center justify-between">
        <!-- Tabs/menú de la Sede -->
        <div class="flex items-center overflow-x-auto py-2 gap-2 scrollbar-hide">
          <a href="sede-dashboard.html" class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2 0v10a1 1 0 01-1 1h-3m-6 0h6"/></svg>
            <span>Dashboard</span>
          </a>
          <a href="sede-consultorios.html" class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg>
            <span>Consultorios</span>
          </a>
          <a href="sede-usuarios.html" class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
            <span>Usuarios</span>
          </a>
          <a href="sede-medicos.html" class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M4 7a4 4 0 118 0 4 4 0 01-8 0zm12 4h4m-2-2v4m-6 4a6 6 0 10-12 0"/></svg>
            <span>Médicos</span>
          </a>
          <a href="sede-especialidades.html" class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 6a3 3 0 10-6 0v5a3 3 0 106 0V9m0 2a4 4 0 104 4h1a3 3 0 003-3V6"/></svg>
            <span>Especialidades</span>
          </a>
          <a href="sede-servicios.html" class="flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 7l9-4 9 4-9 4-9-4m0 5l9 4 9-4m-18 5l9 4 9-4"/></svg>
            <span>Servicios</span>
          </a>
          <!-- Horarios activo -->
          <a href="sede-horarios.html" aria-current="page" class="flex items-center gap-2 rounded-lg bg-brand-50 px-3 py-2 text-sm font-semibold text-brand-700 border-b-2 border-brand-600 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6v6l4 2m6-2a10 10 0 11-20 0 10 10 0 0120 0z"/></svg>
            <span>Horarios</span>
          </a>
        </div>
        <!-- Acciones rápidas a la derecha -->
        <div class="flex items-center gap-2">
          <a href="#" class="hidden md:flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-width="1.5" d="M8 7V3m8 4V3M3 11h18M5 19h14a2 2 0 002-2v-6H3v6a2 2 0 002 2z"/></svg><span>Agenda</span></a>
          <a href="#" class="hidden md:flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-width="1.5" d="M12 6v12m6-6H6"/></svg><span>Reservas</span></a>
          <a href="#" class="hidden md:flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5 text-brand-600"><path stroke-width="1.5" d="M12 14l9-5-9-5-9 5 9 5z"/><path stroke-width="1.5" d="M12 14l6.16-3.422A12.083 12.083 0 016 8.577M12 14v7"/></svg><span>Reportes</span></a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main -->
  <main class="pt-36 pb-24">
    <div class="mx-auto max-w-screen-2xl px-6">
      <!-- Breadcrumbs & Header -->
      <div class="mb-6 flex flex-wrap items-center justify-between gap-3">
        <div>
          <nav class="text-xs text-slate-500"><a class="hover:underline" href="ipress.html">IPRESS</a> / <a class="hover:underline" href="sede-dashboard.html">Sede Miraflores</a> / <span class="text-slate-700 font-medium">Horarios</span></nav>
          <h1 class="mt-1 text-2xl font-semibold tracking-tight text-slate-800">Horarios de la Sede</h1>
          <p class="text-sm text-slate-500">Configura disponibilidad por <span class="font-medium">médico</span>, <span class="font-medium">servicio</span> y <span class="font-medium">consultorio</span>. Incluye excepciones y feriados.</p>
        </div>
        <div class="flex flex-wrap items-center gap-2">
          <a href="sede-horarios-formulario.html" class="rounded-lg bg-brand-600 px-4 py-2 text-sm font-medium text-white shadow-soft hover:bg-brand-700">+ Nuevo horario</a>
          <button id="btnPlantilla" class="rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50">Importar plantilla</button>
          <button id="btnExcepcion" class="rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50">Excepción</button>
          <button id="btnFeriado" class="rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50">Feriados</button>
        </div>
      </div>

      <!-- KPIs -->
      <section class="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
        <article class="rounded-2xl border bg-white p-5 shadow-soft"><p class="text-xs uppercase text-slate-400">Franjas activas</p><h3 class="mt-1 text-3xl font-semibold">86</h3><p class="text-xs text-slate-500">Semana actual</p></article>
        <article class="rounded-2xl border bg-white p-5 shadow-soft"><p class="text-xs uppercase text-slate-400">Médicos con agenda</p><h3 class="mt-1 text-3xl font-semibold">24</h3><p class="text-xs text-slate-500">de 32 disponibles</p></article>
        <article class="rounded-2xl border bg-white p-5 shadow-soft"><p class="text-xs uppercase text-slate-400">Servicios habilitados</p><h3 class="mt-1 text-3xl font-semibold">58</h3><p class="text-xs text-slate-500">con horarios vigentes</p></article>
        <article class="rounded-2xl border bg-white p-5 shadow-soft"><p class="text-xs uppercase text-slate-400">Ocupación (hoy)</p><h3 class="mt-1 text-3xl font-semibold">76%</h3><p class="text-xs text-slate-500">pico 10:00–12:00</p></article>
      </section>

      <!-- Filtros -->
      <section class="mt-6 rounded-2xl border border-slate-200 bg-white p-4 shadow-soft">
        <form id="filtros" class="grid gap-3 md:grid-cols-8">
          <div class="md:col-span-2">
            <label class="mb-1 block text-xs font-medium text-slate-600">Rango de fechas</label>
            <div class="grid grid-cols-2 gap-2"><input type="date" class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm"/><input type="date" class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm"/></div>
          </div>
          <div class="md:col-span-2">
            <label class="mb-1 block text-xs font-medium text-slate-600">Médico</label>
            <input type="text" list="lstMedicos" placeholder="Nombre o CMP" class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm"/>
            <datalist id="lstMedicos"><option>Dr. Juan Pérez (CMP 12345)</option><option>Dra. Ana Rivera (CMP 98765)</option><option>Dr. Marco Ruiz (CMP 54321)</option></datalist>
          </div>
          <div>
            <label class="mb-1 block text-xs font-medium text-slate-600">Servicio</label>
            <select class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm"><option>Todos</option><option>Consulta cardiología</option><option>Pediatría general</option><option>Dermatología</option></select>
          </div>
          <div>
            <label class="mb-1 block text-xs font-medium text-slate-600">Consultorio</label>
            <select class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm"><option>Todos</option><option>Consultorio 101</option><option>Consultorio 203</option><option>Emergencia Box 5</option></select>
          </div>
          <div>
            <label class="mb-1 block text-xs font-medium text-slate-600">Modalidad</label>
            <select class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm"><option>Todas</option><option>Presencial</option><option>Virtual</option><option>Domiciliaria</option></select>
          </div>
          <div>
            <label class="mb-1 block text-xs font-medium text-slate-600">Canal</label>
            <select class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm"><option>Todos</option><option>Web</option><option>Call center</option><option>Ventanilla</option></select>
          </div>
          <div class="mt-5 flex flex-wrap items-center gap-2 md:col-span-2">
            <button type="button" id="btnLimpiar" class="rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm hover:bg-slate-50">Limpiar</button>
            <button type="button" id="btnAplicar" class="rounded-lg bg-brand-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-brand-700">Aplicar filtros</button>
          </div>
        </form>
      </section>

      <!-- Tabs vista -->
      <div class="mt-6 border-b border-slate-200">
        <nav class="-mb-px flex gap-6 text-sm">
          <button type="button" data-tab="semana" class="tab-btn border-b-2 border-brand-600 px-1 pb-2 font-medium text-brand-600">Semana</button>
          <button type="button" data-tab="dia" class="tab-btn border-b-2 border-transparent px-1 pb-2 font-medium text-slate-500 hover:text-slate-700">Día</button>
          <button type="button" data-tab="lista" class="tab-btn border-b-2 border-transparent px-1 pb-2 font-medium text-slate-500 hover:text-slate-700">Lista</button>
          <button type="button" data-tab="excepciones" class="tab-btn border-b-2 border-transparent px-1 pb-2 font-medium text-amber-600 hover:text-amber-700">Excepciones</button>
        </nav>
      </div>

      <!-- Vista SEMANA -->
      <section id="semana" class="tab-panel mt-6 space-y-3">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2 text-sm">
            <button class="rounded-md border border-slate-200 bg-white px-2 py-1 hover:bg-slate-50">◀</button>
            <button class="rounded-md border border-slate-200 bg-white px-2 py-1 hover:bg-slate-50">Hoy</button>
            <button class="rounded-md border border-slate-200 bg-white px-2 py-1 hover:bg-slate-50">▶</button>
            <span class="ml-2 text-slate-600">Semana 34 • 18–24 Ago</span>
          </div>
          <div class="flex items-center gap-2 text-sm">
            <label class="inline-flex items-center gap-2"><input type="checkbox" class="h-4 w-4 rounded border-slate-300 text-brand-600"> Mostrar ocupación</label>
            <label class="inline-flex items-center gap-2"><input type="checkbox" class="h-4 w-4 rounded border-slate-300 text-brand-600"> Solapes</label>
          </div>
        </div>

        <div class="overflow-x-auto rounded-2xl border border-slate-200 bg-white shadow-soft">
          <div class="grid-week">
            <!-- Columna horas -->
            <div class="bg-slate-50 p-2 text-right text-xs text-slate-500">
              <div class="grid-hours">
                <div>08:00</div><div>09:00</div><div>10:00</div><div>11:00</div><div>12:00</div><div>13:00</div><div>14:00</div><div>15:00</div><div>16:00</div><div>17:00</div><div>18:00</div><div>19:00</div>
              </div>
            </div>
            <!-- Días se construyen dinámicamente -->
            <div id="weekCols" class="contents"></div>
          </div>
        </div>
        <p class="text-xs text-slate-500">Las tarjetas muestran <span class="font-medium">Médico • Servicio • Consultorio</span> y cupos/intervalos. Fuente: tablas <span class="font-medium">sede_horario</span> (cabecera) y <span class="font-medium">sede_horario_detalle</span> (franjas).</p>
        <div class="mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg">
          <p class="text-xs text-blue-700"><strong>Nota:</strong> Esta es una demostración con datos de ejemplo. En una implementación real, los datos se cargarían desde la base de datos y se actualizarían dinámicamente.</p>
        </div>
      </section>

      <!-- Vista DÍA -->
      <section id="dia" class="tab-panel hidden mt-6 rounded-2xl border border-slate-200 bg-white p-4 shadow-soft">
        <div class="mb-3 flex items-center justify-between">
          <h2 class="text-lg font-semibold">Hoy • 20/08</h2>
          <div class="flex items-center gap-2 text-sm"><button class="rounded-md border border-slate-200 bg-white px-2 py-1 hover:bg-slate-50">◀</button><button class="rounded-md border border-slate-200 bg-white px-2 py-1 hover:bg-slate-50">▶</button></div>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full text-left text-sm">
            <thead class="border-y border-slate-200 bg-slate-50 text-slate-500">
              <tr>
                <th class="px-3 py-2">Médico</th>
                <th class="px-3 py-2">Servicio</th>
                <th class="px-3 py-2">Consultorio</th>
                <th class="px-3 py-2">Desde</th>
                <th class="px-3 py-2">Hasta</th>
                <th class="px-3 py-2">Intervalo</th>
                <th class="px-3 py-2">Cupo</th>
                <th class="px-3 py-2">Canales</th>
                <th class="px-3 py-2">Estado</th>
                <th class="px-3 py-2 text-right">Acciones</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-slate-100" id="tblDia"></tbody>
          </table>
        </div>
      </section>

      <!-- Vista LISTA (todas las franjas) -->
      <section id="lista" class="tab-panel hidden mt-6 rounded-2xl border border-slate-200 bg-white p-4 shadow-soft">
        <div class="mb-3 flex items-center justify-between">
          <h2 class="text-lg font-semibold">Listado de franjas</h2>
          <div class="flex items-center gap-2 text-sm"><button class="rounded-md border border-slate-200 bg-white px-2 py-1 hover:bg-slate-50">Exportar</button></div>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full text-left text-sm">
            <thead class="border-y border-slate-200 bg-slate-50 text-slate-500">
              <tr>
                <th class="px-3 py-2"><input id="chkAll" type="checkbox" class="h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-600"/></th>
                <th class="px-3 py-2">Médico</th>
                <th class="px-3 py-2">Servicio</th>
                <th class="px-3 py-2">Especialidad</th>
                <th class="px-3 py-2">Consultorio</th>
                <th class="px-3 py-2">Día</th>
                <th class="px-3 py-2">Desde</th>
                <th class="px-3 py-2">Hasta</th>
                <th class="px-3 py-2">Intervalo</th>
                <th class="px-3 py-2">Cupo</th>
                <th class="px-3 py-2">Canales</th>
                <th class="px-3 py-2">Estado</th>
                <th class="px-3 py-2 text-right">Acciones</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-slate-100" id="tblLista"></tbody>
          </table>
        </div>
        <div class="mt-4 flex items-center justify-between">
          <div class="text-sm text-slate-500">Acciones masivas:</div>
          <div class="flex items-center gap-2 text-sm">
            <button class="rounded-md border border-slate-200 bg-white px-2 py-1 hover:bg-slate-50">Activar</button>
            <button class="rounded-md border border-slate-200 bg-white px-2 py-1 hover:bg-slate-50">Inactivar</button>
            <button class="rounded-md border border-slate-200 bg-white px-2 py-1 hover:bg-slate-50">Duplicar</button>
            <button class="rounded-md border border-slate-200 bg-white px-2 py-1 hover:bg-slate-50">Eliminar</button>
          </div>
        </div>
      </section>

      <!-- Vista EXCEPCIONES -->
      <section id="excepciones" class="tab-panel hidden mt-6 grid gap-6 lg:grid-cols-3">
        <div class="lg:col-span-2 rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
          <div class="mb-3 flex items-center justify-between">
            <h2 class="text-lg font-semibold">Excepciones programadas</h2>
            <button class="rounded-lg bg-amber-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-amber-700">+ Nueva excepción</button>
          </div>
          <div class="overflow-x-auto">
            <table class="min-w-full text-left text-sm">
              <thead class="border-y border-slate-200 bg-slate-50 text-slate-500"><tr><th class="px-3 py-2">Fecha</th><th class="px-3 py-2">Médico/Servicio</th><th class="px-3 py-2">Tipo</th><th class="px-3 py-2">Motivo</th><th class="px-3 py-2">Estado</th><th class="px-3 py-2 text-right">Acciones</th></tr></thead>
              <tbody class="divide-y divide-slate-100" id="tblExc"></tbody>
            </table>
          </div>
        </div>
        <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
          <h3 class="mb-2 text-sm font-semibold text-slate-800">Ocupación semanal (demo)</h3>
          <div class="h-52"><canvas id="chOcup"></canvas></div>
          <p class="mt-2 text-xs text-slate-500">Fuente: reservas confirmadas vs. cupos de <span class="font-medium">sede_horario_detalle</span>.</p>
        </div>
      </section>

    </div>
  </main>

  <!-- Footer -->
  <footer class="fixed bottom-0 inset-x-0 z-40 border-t border-slate-200 bg-white/90 backdrop-blur">
    <div class="mx-auto flex h-12 max-w-screen-2xl items-center justify-between px-6 text-sm text-slate-600">
      <p>© <span id="y"></span> NextIaCorp • Sede Miraflores</p>
      <nav class="hidden gap-4 md:flex">
        <a class="hover:text-slate-900" href="#">Privacidad</a>
        <a class="hover:text-slate-900" href="#">Términos</a>
        <a class="hover:text-slate-900" href="#">Contacto</a>
      </nav>
    </div>
  </footer>

  <!-- Modales (demo) -->
  <div id="mdlNuevo" class="fixed inset-0 z-50 hidden items-center justify-center bg-slate-900/30 p-4">
    <div class="w-full max-w-2xl rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
      <h3 class="text-base font-semibold text-slate-800">Nuevo horario</h3>
      <p class="text-sm text-slate-600">Crea una franja por médico/servicio/consultorio.</p>
      <div class="mt-3 grid gap-3 md:grid-cols-3">
        <input class="rounded-lg border border-slate-200 px-3 py-2 text-sm" placeholder="Médico"/>
        <select class="rounded-lg border border-slate-200 px-3 py-2 text-sm"><option>Servicio</option><option>Consulta cardiología</option></select>
        <select class="rounded-lg border border-slate-200 px-3 py-2 text-sm"><option>Consultorio</option><option>Consultorio 101</option></select>
        <select class="rounded-lg border border-slate-200 px-3 py-2 text-sm"><option>Lunes</option><option>Martes</option><option>Miércoles</option><option>Jueves</option><option>Viernes</option><option>Sábado</option></select>
        <input type="time" class="rounded-lg border border-slate-200 px-3 py-2 text-sm" value="09:00"/>
        <input type="time" class="rounded-lg border border-slate-200 px-3 py-2 text-sm" value="13:00"/>
        <input type="number" class="rounded-lg border border-slate-200 px-3 py-2 text-sm" placeholder="Intervalo (min)" value="20"/>
        <input type="number" class="rounded-lg border border-slate-200 px-3 py-2 text-sm" placeholder="Cupo" value="1"/>
        <select class="rounded-lg border border-slate-200 px-3 py-2 text-sm" multiple><option selected>Web</option><option>Call center</option><option>Ventanilla</option></select>
      </div>
      <div class="mt-4 flex justify-end gap-2"><button data-close class="rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm hover:bg-slate-50">Cancelar</button><button class="rounded-lg bg-brand-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-brand-700">Guardar</button></div>
    </div>
  </div>

  <script>
    // Año
    document.getElementById('y').textContent = new Date().getFullYear();

    // Tabs
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const tab = btn.dataset.tab;
        document.querySelectorAll('.tab-btn').forEach(b => { 
          b.classList.remove('border-brand-600','text-brand-600'); 
          b.classList.add('border-transparent','text-slate-500'); 
        });
        btn.classList.add('border-brand-600','text-brand-600'); 
        btn.classList.remove('border-transparent','text-slate-500');
        document.querySelectorAll('.tab-panel').forEach(p => p.classList.add('hidden'));
        document.getElementById(tab).classList.remove('hidden');
      });
    });

    // Construir columnas de semana y eventos demo
    function buildWeekView() {
      const weekCols = document.getElementById('weekCols');
      weekCols.innerHTML = ''; // Limpiar contenido existente
      
      const dias = ['Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb', 'Dom'];
      
      for(let i = 0; i < 7; i++){
        const col = document.createElement('div');
        col.className = 'relative border-l border-slate-100';
        
        const header = document.createElement('div');
        header.className = 'sticky top-0 z-10 border-b border-slate-100 bg-white/95 px-3 py-2 text-xs font-medium';
        header.textContent = dias[i];
        
        const grid = document.createElement('div');
        grid.className = 'grid-hours';
        
        // Crear slots para cada hora
        for(let h = 0; h < 12; h++){
          const slot = document.createElement('div');
          slot.className = 'slot';
          grid.appendChild(slot);
        }
        
        col.appendChild(header);
        col.appendChild(grid);
        weekCols.appendChild(col);
      }
      
          // Insertar eventos demo después de construir las columnas
    setTimeout(() => {
      addEvent(0, 1, 3, 'linear-gradient(135deg,#a5f3fc,#4f46e5)', '<b>Dr. Pérez</b><br><span class="text-xs">Cardiología • Cons. 101</span><br><span class="text-[10px]">09:00–12:00 • Int 20 • Cupo 1</span>', {medico: 'Dr. Pérez', servicio: 'Cardiología', consultorio: 'Cons. 101', hora: '09:00-12:00', intervalo: '20 min', cupo: '1'});
      addEvent(1, 4, 2, 'linear-gradient(135deg,#bef264,#06b6d4)', '<b>Dra. Rivera</b><br><span class="text-xs">Dermatología • Cons. 203</span><br><span class="text-[10px]">12:00–14:00 • Int 15 • Cupo 1</span>', {medico: 'Dra. Rivera', servicio: 'Dermatología', consultorio: 'Cons. 203', hora: '12:00-14:00', intervalo: '15 min', cupo: '1'});
      addEvent(3, 2, 4, 'linear-gradient(135deg,#fecaca,#a5b4fc)', '<b>Dr. Ruiz</b><br><span class="text-xs">Pediatría • Cons. 105</span><br><span class="text-[10px]">10:00–14:00 • Int 20 • Cupo 2</span>', {medico: 'Dr. Ruiz', servicio: 'Pediatría', consultorio: 'Cons. 105', hora: '10:00-14:00', intervalo: '20 min', cupo: '2'});
      addEvent(2, 0, 2, 'linear-gradient(135deg,#fef3c7,#f59e0b)', '<b>Dr. López</b><br><span class="text-xs">Ginecología • Cons. 201</span><br><span class="text-[10px]">08:00–10:00 • Int 30 • Cupo 1</span>', {medico: 'Dr. López', servicio: 'Ginecología', consultorio: 'Cons. 201', hora: '08:00-10:00', intervalo: '30 min', cupo: '1'});
      addEvent(4, 3, 3, 'linear-gradient(135deg,#d1fae5,#10b981)', '<b>Dra. Torres</b><br><span class="text-xs">Oftalmología • Cons. 103</span><br><span class="text-[10px]">11:00–14:00 • Int 25 • Cupo 1</span>', {medico: 'Dra. Torres', servicio: 'Oftalmología', consultorio: 'Cons. 103', hora: '11:00-14:00', intervalo: '25 min', cupo: '1'});
      addEvent(5, 1, 2, 'linear-gradient(135deg,#e0e7ff,#6366f1)', '<b>Dr. Silva</b><br><span class="text-xs">Traumatología • Cons. 205</span><br><span class="text-[10px]">09:00–11:00 • Int 20 • Cupo 1</span>', {medico: 'Dr. Silva', servicio: 'Traumatología', consultorio: 'Cons. 205', hora: '09:00-11:00', intervalo: '20 min', cupo: '1'});
    }, 100);
    }

    // Insertar eventos demo
    function addEvent(dayIdx, startRow, spanRows, color, text, data){
      const weekCols = document.getElementById('weekCols');
      if (weekCols.children[dayIdx]) {
        const day = weekCols.children[dayIdx];
        const grid = day.querySelector('.grid-hours');
        if (grid && grid.children[startRow]) {
          const slot = grid.children[startRow];
          const ev = document.createElement('div');
          ev.className = 'event';
          ev.style.top = '4px';
          ev.style.height = (spanRows*56 - 8) + 'px';
          ev.style.background = color;
          ev.style.color = '#0b1229';
          ev.innerHTML = text;
          
          // Hacer el evento clickeable
          ev.addEventListener('click', () => {
            showEventDetails(data);
          });
          
          slot.appendChild(ev);
        }
      }
    }

    // Mostrar detalles del evento
    function showEventDetails(data) {
      const modal = document.createElement('div');
      modal.className = 'fixed inset-0 z-50 flex items-center justify-center bg-slate-900/30 p-4';
      modal.innerHTML = `
        <div class="w-full max-w-md rounded-2xl border border-slate-200 bg-white p-5 shadow-soft">
          <h3 class="text-lg font-semibold text-slate-800 mb-3">Detalles del Horario</h3>
          <div class="space-y-2 text-sm">
            <div><span class="font-medium text-slate-600">Médico:</span> ${data.medico}</div>
            <div><span class="font-medium text-slate-600">Servicio:</span> ${data.servicio}</div>
            <div><span class="font-medium text-slate-600">Consultorio:</span> ${data.consultorio}</div>
            <div><span class="font-medium text-slate-600">Horario:</span> ${data.hora}</div>
            <div><span class="font-medium text-slate-600">Intervalo:</span> ${data.intervalo}</div>
            <div><span class="font-medium text-slate-600">Cupo:</span> ${data.cupo}</div>
          </div>
          <div class="mt-4 flex justify-end gap-2">
            <button class="rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm hover:bg-slate-50" onclick="this.closest('.fixed').remove()">Cerrar</button>
            <button class="rounded-lg bg-brand-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-brand-700">Editar</button>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
      
      // Cerrar modal al hacer clic fuera
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.remove();
        }
      });
    }

    // Construir vista semanal al cargar la página
    document.addEventListener('DOMContentLoaded', function() {
      buildWeekView();
    });

    // Tabla DÍA demo con más datos
    const tblDia = document.getElementById('tblDia');
    const datosDia = [
      ['Dr. Pérez', 'Cardiología', 'Cons. 101', '09:00', '12:00', '20', '1', 'Web, Call', 'Activo'],
      ['Dra. Rivera', 'Dermatología', 'Cons. 203', '12:00', '14:00', '15', '1', 'Web', 'Activo'],
      ['Dr. Ruiz', 'Pediatría', 'Cons. 105', '10:00', '14:00', '20', '2', 'Web, Vent', 'Activo'],
      ['Dr. López', 'Ginecología', 'Cons. 201', '08:00', '10:00', '30', '1', 'Web, Call', 'Activo'],
      ['Dra. Torres', 'Oftalmología', 'Cons. 103', '11:00', '14:00', '25', '1', 'Web', 'Activo']
    ];
    
    datosDia.forEach(r => {
      const tr = document.createElement('tr');
      tr.className = 'hover:bg-slate-50/60';
      tr.innerHTML = `<td class="px-3 py-2">${r[0]}</td><td class="px-3 py-2">${r[1]}</td><td class="px-3 py-2">${r[2]}</td><td class="px-3 py-2">${r[3]}</td><td class="px-3 py-2">${r[4]}</td><td class="px-3 py-2">${r[5]} min</td><td class="px-3 py-2">${r[6]}</td><td class="px-3 py-2">${r[7]}</td><td class="px-3 py-2"><span class='rounded-full bg-emerald-50 px-2.5 py-1 text-xs font-medium text-emerald-700'>Activo</span></td><td class="px-3 py-2 text-right"><button class='rounded-md border border-slate-200 bg-white px-2 py-1 text-xs hover:bg-slate-50'>Editar</button></td>`;
      tblDia.appendChild(tr);
    });

    // Tabla LISTA demo con más datos
    const tblLista = document.getElementById('tblLista');
    const rows = [
      {med:'Dr. Pérez', srv:'Consulta cardiología', esp:'Cardiología', con:'Cons. 101', dia:'Lun', de:'09:00', a:'12:00', int:20, cupo:1, canales:'Web, Call', est:'Activo'},
      {med:'Dra. Rivera', srv:'Dermatología', esp:'Dermatología', con:'Cons. 203', dia:'Mar', de:'12:00', a:'14:00', int:15, cupo:1, canales:'Web', est:'Activo'},
      {med:'Dr. Ruiz', srv:'Pediatría', esp:'Pediatría', con:'Cons. 105', dia:'Jue', de:'10:00', a:'14:00', int:20, cupo:2, canales:'Web, Vent', est:'Activo'},
      {med:'Dr. López', srv:'Ginecología', esp:'Ginecología', con:'Cons. 201', dia:'Mié', de:'08:00', a:'10:00', int:30, cupo:1, canales:'Web, Call', est:'Activo'},
      {med:'Dra. Torres', srv:'Oftalmología', esp:'Oftalmología', con:'Cons. 103', dia:'Vie', de:'11:00', a:'14:00', int:25, cupo:1, canales:'Web', est:'Activo'},
      {med:'Dr. Silva', srv:'Traumatología', esp:'Traumatología', con:'Cons. 205', dia:'Sáb', de:'09:00', a:'11:00', int:20, cupo:1, canales:'Web', est:'Inactivo'},
      {med:'Dra. Mendoza', srv:'Neurología', esp:'Neurología', con:'Cons. 107', dia:'Lun', de:'14:00', a:'17:00', int:30, cupo:1, canales:'Web, Call', est:'Activo'},
      {med:'Dr. Castro', srv:'Urología', esp:'Urología', con:'Cons. 209', dia:'Mar', de:'15:00', a:'18:00', int:25, cupo:1, canales:'Web', est:'Activo'}
    ];
    
    rows.forEach(r => {
      const tr = document.createElement('tr');
      tr.className = 'hover:bg-slate-50/60';
      tr.innerHTML = `<td class='px-3 py-2'><input type='checkbox' class='h-4 w-4 rounded border-slate-300 text-brand-600 focus:ring-brand-600'/></td>
        <td class='px-3 py-2'>${r.med}</td><td class='px-3 py-2'>${r.srv}</td><td class='px-3 py-2'>${r.esp}</td><td class='px-3 py-2'>${r.con}</td>
        <td class='px-3 py-2'>${r.dia}</td><td class='px-3 py-2'>${r.de}</td><td class='px-3 py-2'>${r.a}</td>
        <td class='px-3 py-2'>${r.int} min</td><td class='px-3 py-2'>${r.cupo}</td><td class='px-3 py-2'>${r.canales}</td>
        <td class='px-3 py-2'><span class='rounded-full ${r.est==='Activo'?'bg-emerald-50 text-emerald-700':'bg-slate-100 text-slate-600'} px-2.5 py-1 text-xs font-medium'>${r.est}</span></td>
        <td class='px-3 py-2 text-right'><div class='inline-flex gap-1'><button class='rounded-md border border-slate-200 bg-white px-2 py-1 text-xs hover:bg-slate-50'>Editar</button><button class='rounded-md border border-slate-200 bg-white px-2 py-1 text-xs hover:bg-slate-50'>Duplicar</button></div></td>`;
      tblLista.appendChild(tr);
    });

    // Excepciones demo con más datos
    const tblExc = document.getElementById('tblExc');
    const excepciones = [
      {f:'22/08/2025', ms:'Dr. Pérez • Cardiología', tipo:'Bloqueo', mot:'Capacitación', est:'Aprobada'},
      {f:'23/08/2025', ms:'Dra. Rivera • Dermatología', tipo:'Horario extendido', mot:'Campaña', est:'Pendiente'},
      {f:'25/08/2025', ms:'Dr. Ruiz • Pediatría', tipo:'Bloqueo', mot:'Vacaciones', est:'Aprobada'},
      {f:'26/08/2025', ms:'Dr. López • Ginecología', tipo:'Horario reducido', mot:'Consulta externa', est:'Pendiente'},
      {f:'28/08/2025', ms:'Dra. Torres • Oftalmología', tipo:'Bloqueo', mot:'Congreso médico', est:'Aprobada'}
    ];
    
    excepciones.forEach(e => {
      const tr = document.createElement('tr');
      tr.className = 'hover:bg-slate-50/60';
      tr.innerHTML = `<td class='px-3 py-2'>${e.f}</td><td class='px-3 py-2'>${e.ms}</td><td class='px-3 py-2'>${e.tipo}</td><td class='px-3 py-2'>${e.mot}</td><td class='px-3 py-2'><span class='rounded-full ${e.est==='Aprobada'?'bg-emerald-50 text-emerald-700':'bg-amber-50 text-amber-700'} px-2.5 py-1 text-xs font-medium'>${e.est}</span></td><td class='px-3 py-2 text-right'><button class='rounded-md border border-slate-200 bg-white px-2 py-1 text-xs hover:bg-slate-50'>Editar</button></td>`;
      tblExc.appendChild(tr);
    });

    // Chart demo mejorado
    if(window.Chart){
      const ctx = document.getElementById('chOcup');
      if (ctx) {
        new Chart(ctx, { 
          type: 'bar', 
          data: { 
            labels: ['Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'], 
            datasets: [{ 
              label: '% Ocupación', 
              data: [72, 78, 69, 80, 75, 55],
              backgroundColor: 'rgba(99, 102, 241, 0.8)',
              borderColor: 'rgba(99, 102, 241, 1)',
              borderWidth: 1
            }] 
          }, 
          options: { 
            responsive: true,
            maintainAspectRatio: false,
            plugins: { 
              legend: { display: false }
            }, 
            scales: { 
              y: { 
                beginAtZero: true, 
                max: 100,
                ticks: { 
                  callback: v => v + '%' 
                } 
              } 
            } 
          } 
        });
      }
    }

    // Modales
    const toggle = (id, show) => {
      const el = document.getElementById(id);
      el.classList.toggle('hidden', !show); 
      el.classList.toggle('flex', show);
    };
    
    document.getElementById('btnNuevo').onclick = () => toggle('mdlNuevo', true);
    document.querySelectorAll('[data-close]').forEach(b => b.onclick = () => toggle('mdlNuevo', false));

    // Funcionalidad para el checkbox "Seleccionar todos"
    document.getElementById('chkAll').addEventListener('change', function() {
      const checkboxes = document.querySelectorAll('#tblLista tbody input[type="checkbox"]');
      checkboxes.forEach(checkbox => {
        checkbox.checked = this.checked;
      });
    });

    // Navegación de semanas
    let currentWeek = 0;
    const weekLabels = [
      'Semana 34 • 18–24 Ago',
      'Semana 35 • 25–31 Ago', 
      'Semana 36 • 1–7 Sep',
      'Semana 33 • 11–17 Ago'
    ];

    document.querySelectorAll('button').forEach(btn => {
      if (btn.textContent === '◀') {
        btn.onclick = () => {
          currentWeek = Math.max(0, currentWeek - 1);
          updateWeekLabel();
          buildWeekView();
        };
      } else if (btn.textContent === '▶') {
        btn.onclick = () => {
          currentWeek = Math.min(weekLabels.length - 1, currentWeek + 1);
          updateWeekLabel();
          buildWeekView();
        };
      } else if (btn.textContent === 'Hoy') {
        btn.onclick = () => {
          currentWeek = 0;
          updateWeekLabel();
          buildWeekView();
        };
      }
    });

    function updateWeekLabel() {
      const weekSpan = document.querySelector('.text-slate-600');
      if (weekSpan) {
        weekSpan.textContent = weekLabels[currentWeek];
      }
    }

    // Funcionalidad para los botones de filtros
    document.getElementById('btnLimpiar').addEventListener('click', function() {
      const inputs = document.querySelectorAll('#filtros input, #filtros select');
      inputs.forEach(input => {
        if (input.type === 'date') {
          input.value = '';
        } else if (input.type === 'text') {
          input.value = '';
        } else if (input.tagName === 'SELECT') {
          input.selectedIndex = 0;
        }
      });
    });

    document.getElementById('btnAplicar').addEventListener('click', function() {
      // Aquí se aplicarían los filtros reales
      alert('Filtros aplicados. En una implementación real, se filtrarían los datos de la base de datos.');
    });

    // Funcionalidad para los botones de acciones masivas
    document.querySelectorAll('#lista button').forEach(btn => {
      if (btn.textContent === 'Activar' || btn.textContent === 'Inactivar' || btn.textContent === 'Duplicar' || btn.textContent === 'Eliminar') {
        btn.addEventListener('click', function() {
          const selected = document.querySelectorAll('#tblLista tbody input[type="checkbox"]:checked');
          if (selected.length === 0) {
            alert('Selecciona al menos un elemento para realizar esta acción.');
            return;
          }
          alert(`Acción "${this.textContent}" aplicada a ${selected.length} elemento(s).`);
        });
      }
    });
  </script>
</body>
</html>
